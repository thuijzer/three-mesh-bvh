{"mappings":"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","sources":["node_modules/stats.js/build/stats.min.js","example/skinnedMesh.js"],"sourcesContent":["// stats.js - http://github.com/mrdoob/stats.js\n(function(f,e){\"object\"===typeof exports&&\"undefined\"!==typeof module?module.exports=e():\"function\"===typeof define&&define.amd?define(e):f.Stats=e()})(this,function(){var f=function(){function e(a){c.appendChild(a.dom);return a}function u(a){for(var d=0;d<c.children.length;d++)c.children[d].style.display=d===a?\"block\":\"none\";l=a}var l=0,c=document.createElement(\"div\");c.style.cssText=\"position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000\";c.addEventListener(\"click\",function(a){a.preventDefault();\nu(++l%c.children.length)},!1);var k=(performance||Date).now(),g=k,a=0,r=e(new f.Panel(\"FPS\",\"#0ff\",\"#002\")),h=e(new f.Panel(\"MS\",\"#0f0\",\"#020\"));if(self.performance&&self.performance.memory)var t=e(new f.Panel(\"MB\",\"#f08\",\"#201\"));u(0);return{REVISION:16,dom:c,addPanel:e,showPanel:u,begin:function(){k=(performance||Date).now()},end:function(){a++;var c=(performance||Date).now();h.update(c-k,200);if(c>g+1E3&&(r.update(1E3*a/(c-g),100),g=c,a=0,t)){var d=performance.memory;t.update(d.usedJSHeapSize/\n1048576,d.jsHeapSizeLimit/1048576)}return c},update:function(){k=this.end()},domElement:c,setMode:u}};f.Panel=function(e,f,l){var c=Infinity,k=0,g=Math.round,a=g(window.devicePixelRatio||1),r=80*a,h=48*a,t=3*a,v=2*a,d=3*a,m=15*a,n=74*a,p=30*a,q=document.createElement(\"canvas\");q.width=r;q.height=h;q.style.cssText=\"width:80px;height:48px\";var b=q.getContext(\"2d\");b.font=\"bold \"+9*a+\"px Helvetica,Arial,sans-serif\";b.textBaseline=\"top\";b.fillStyle=l;b.fillRect(0,0,r,h);b.fillStyle=f;b.fillText(e,t,v);\nb.fillRect(d,m,n,p);b.fillStyle=l;b.globalAlpha=.9;b.fillRect(d,m,n,p);return{dom:q,update:function(h,w){c=Math.min(c,h);k=Math.max(k,h);b.fillStyle=l;b.globalAlpha=1;b.fillRect(0,0,r,m);b.fillStyle=f;b.fillText(g(h)+\" \"+e+\" (\"+g(c)+\"-\"+g(k)+\")\",t,v);b.drawImage(q,d+a,m,n-a,p,d,m,n-a,p);b.fillRect(d+n-a,m,a,p);b.fillStyle=l;b.globalAlpha=.9;b.fillRect(d+n-a,m,a,g((1-h/w)*p))}}};return f});\n","import * as THREE from 'three';\nimport { GLTFLoader } from 'three/examples/jsm/loaders/GLTFLoader.js';\nimport Stats from 'stats.js';\nimport { GUI } from 'three/examples/jsm/libs/lil-gui.module.min.js';\nimport { computeBoundsTree, MeshBVHVisualizer, getBVHExtremes, StaticGeometryGenerator, SAH } from '..';\nimport { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';\n\nTHREE.BufferGeometry.prototype.computeBoundsTree = computeBoundsTree;\n\nconst params = {\n\tdisplay: true,\n\tdisplayOriginal: true,\n\tmaterial: 'wireframe',\n\tupdatePositionOnly: false,\n\n\tskeletonHelper: false,\n\tbvhHelper: true,\n\tbvhHelperDepth: 10,\n\n\tautoUpdate: true,\n\tupdateRate: 2.5,\n\tpause: false,\n\tregenerate: () => {\n\n\t\tregenerateMesh();\n\n\t}\n};\n\nlet renderer, camera, scene, clock, gui, stats;\nlet outputContainer;\nlet controls, mixer, animationAction, model;\nlet bvhHelper, skeletonHelper, meshHelper, staticGeometryGenerator;\nlet timeSinceUpdate = 0;\nlet initialExtremes = null;\nlet wireframeMaterial, normalMaterials, originalMaterials;\n\ninit();\nrender();\n\n// TODO: afford use of materials on the final model to validate\n\nfunction init() {\n\n\tconst bgColor = 0x111111;\n\n\toutputContainer = document.getElementById( 'output' );\n\n\t// renderer setup\n\trenderer = new THREE.WebGLRenderer( { antialias: true } );\n\trenderer.setPixelRatio( window.devicePixelRatio );\n\trenderer.setSize( window.innerWidth, window.innerHeight );\n\trenderer.setClearColor( bgColor, 1 );\n\trenderer.shadowMap.enabled = true;\n\trenderer.shadowMap.type = THREE.PCFSoftShadowMap;\n\trenderer.outputEncoding = THREE.sRGBEncoding;\n\tdocument.body.appendChild( renderer.domElement );\n\n\t// scene setup\n\tscene = new THREE.Scene();\n\n\tconst light = new THREE.DirectionalLight( 0xffffff, 1 );\n\tlight.position.set( 5, 5, 2.5 );\n\tlight.shadow.mapSize.setScalar( 1024 );\n\tlight.shadow.normalBias = 1e-2;\n\tlight.castShadow = true;\n\n\tconst shadowCam = light.shadow.camera;\n\tshadowCam.left = shadowCam.bottom = - 7.5;\n\tshadowCam.right = shadowCam.top = 7.5;\n\tshadowCam.updateProjectionMatrix();\n\tscene.add( light );\n\tscene.add( new THREE.AmbientLight( 0xb0bec5, 0.8 ) );\n\n\t// camera setup\n\tcamera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 50 );\n\tcamera.position.set( 10, 0, 0 );\n\tcamera.far = 100;\n\tcamera.updateProjectionMatrix();\n\n\tcontrols = new OrbitControls( camera, renderer.domElement );\n\n\tclock = new THREE.Clock();\n\n\t// stats setup\n\tstats = new Stats();\n\tdocument.body.appendChild( stats.dom );\n\n\t// load the model\n\tnew GLTFLoader().load( 'https://raw.githubusercontent.com/gkjohnson/3d-demo-data/main/models/trex/scene.gltf', gltf => {\n\n\t\t// prep the model and add it to the scene\n\t\tmodel = gltf.scene;\n\t\tconst meshes = [];\n\t\tmodel.traverse( object => {\n\n\t\t\tif ( object.isMesh ) {\n\n\t\t\t\tobject.castShadow = true;\n\t\t\t\tobject.receiveShadow = true;\n\t\t\t\tobject.frustumCulled = false;\n\t\t\t\tmeshes.push( object );\n\n\t\t\t}\n\n\t\t} );\n\n\t\tmodel.updateMatrixWorld( true );\n\t\tscene.add( model );\n\n\t\t// skeleton helper\n\t\tskeletonHelper = new THREE.SkeletonHelper( model );\n\t\tskeletonHelper.visible = false;\n\t\tscene.add( skeletonHelper );\n\n\t\t// animations\n\t\tconst animations = gltf.animations;\n\t\tmixer = new THREE.AnimationMixer( model );\n\n\t\tanimationAction = mixer.clipAction( animations[ 0 ] );\n\t\tanimationAction.play();\n\t\tanimationAction.paused = params.pause;\n\n\t\t// camera setup\n\t\tconst box = new THREE.Box3();\n\t\tbox.setFromObject( model );\n\t\tbox.getCenter( controls.target );\n\t\tbox.getCenter( camera.position );\n\t\tcamera.position.x = 7.5;\n\t\tcamera.position.z = 3.5;\n\t\tcontrols.update();\n\n\t\t// prep the geometry\n\t\tstaticGeometryGenerator = new StaticGeometryGenerator( model );\n\t\toriginalMaterials = staticGeometryGenerator.getMaterials();\n\n\t\tnormalMaterials = originalMaterials.map( m => {\n\n\t\t\treturn new THREE.MeshNormalMaterial( {\n\t\t\t\tnormalMap: m.normalMap\n\t\t\t} );\n\n\t\t} );\n\n\t\twireframeMaterial = new THREE.MeshBasicMaterial( {\n\t\t\twireframe: true,\n\t\t\ttransparent: true,\n\t\t\topacity: 0.05,\n\t\t\tdepthWrite: false,\n\t\t} );\n\t\tmeshHelper = new THREE.Mesh( new THREE.BufferGeometry(), wireframeMaterial );\n\t\tmeshHelper.receiveShadow = true;\n\n\t\tscene.add( meshHelper );\n\n\t\tbvhHelper = new MeshBVHVisualizer( meshHelper, 10 );\n\t\tscene.add( bvhHelper );\n\n\t\tregenerateMesh();\n\n\t} );\n\n\n\tconst plane = new THREE.Mesh( new THREE.PlaneBufferGeometry(), new THREE.ShadowMaterial( { color: 0xffffff, opacity: 0.025, transparent: true } ) );\n\tplane.rotation.x = - Math.PI / 2;\n\tplane.receiveShadow = true;\n\tplane.scale.setScalar( 50 );\n\tscene.add( plane );\n\n\tgui = new GUI();\n\tconst staticFolder = gui.addFolder( 'static mesh' );\n\tstaticFolder.add( params, 'display' );\n\tstaticFolder.add( params, 'displayOriginal' );\n\tstaticFolder.add( params, 'material', [ 'wireframe', 'normal', 'original' ] ).onChange( v => {\n\n\t\tif ( ! meshHelper ) {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tswitch ( v ) {\n\n\t\t\tcase 'wireframe':\n\t\t\t\tmeshHelper.material = wireframeMaterial;\n\t\t\t\tmeshHelper.castShadow = false;\n\t\t\t\tbreak;\n\t\t\tcase 'normal':\n\t\t\t\tmeshHelper.material = normalMaterials;\n\t\t\t\tmeshHelper.castShadow = true;\n\t\t\t\tbreak;\n\t\t\tcase 'original':\n\t\t\t\tmeshHelper.material = originalMaterials;\n\t\t\t\tmeshHelper.castShadow = true;\n\t\t\t\tbreak;\n\n\t\t}\n\n\t} );\n\tstaticFolder.add( params, 'updatePositionOnly' ).onChange( v => {\n\n\t\tstaticGeometryGenerator.attributes = v ? [ 'position' ] : [ 'position', 'normal', 'tangent', 'uv', 'uv2' ];\n\n\t\t// TODO: if we don't dispose and create a new geometry then it seems like the performance gets slower with the\n\t\t// original meshes??\n\t\tconst geometry = meshHelper.geometry;\n\t\tgeometry.dispose();\n\t\tfor ( const key in geometry.attributes ) {\n\n\t\t\tgeometry.deleteAttribute( key );\n\n\t\t}\n\n\t} );\n\tstaticFolder.open();\n\n\tconst helperFolder = gui.addFolder( 'helpers' );\n\thelperFolder.add( params, 'skeletonHelper' );\n\thelperFolder.add( params, 'bvhHelper' );\n\thelperFolder.add( params, 'bvhHelperDepth', 1, 20 ).onChange( v => {\n\n\t\tbvhHelper.depth = parseInt( v );\n\t\tbvhHelper.update();\n\n\t} );\n\thelperFolder.open();\n\n\tconst bvhFolder = gui.addFolder( 'bvh animation' );\n\tbvhFolder.add( params, 'autoUpdate' );\n\tbvhFolder.add( params, 'updateRate', 0, 5, 0.001 );\n\tbvhFolder.add( params, 'pause' ).onChange( v => {\n\n\t\tif ( animationAction ) {\n\n\t\t\tanimationAction.paused = v;\n\n\t\t}\n\n\t} );\n\tbvhFolder.add( params, 'regenerate' );\n\tbvhFolder.open();\n\n\tgui.open();\n\n\twindow.addEventListener( 'resize', function () {\n\n\t\tcamera.aspect = window.innerWidth / window.innerHeight;\n\t\tcamera.updateProjectionMatrix();\n\n\t\trenderer.setSize( window.innerWidth, window.innerHeight );\n\n\t}, false );\n\n}\n\n// regenerate the mesh and bvh\nfunction regenerateMesh() {\n\n\tif ( meshHelper ) {\n\n\t\tlet generateTime, refitTime, startTime;\n\n\t\t// time the geometry generation\n\t\tstartTime = window.performance.now();\n\t\tstaticGeometryGenerator.generate( meshHelper.geometry );\n\t\tgenerateTime = window.performance.now() - startTime;\n\n\t\t// time the bvh refitting\n\t\tstartTime = window.performance.now();\n\t\tif ( ! meshHelper.geometry.boundsTree ) {\n\n\t\t\tmeshHelper.geometry.computeBoundsTree();\n\t\t\trefitTime = '-';\n\n\t\t} else {\n\n\t\t\tmeshHelper.geometry.boundsTree.refit();\n\t\t\trefitTime = ( window.performance.now() - startTime ).toFixed( 2 );\n\n\t\t}\n\n\t\tbvhHelper.update();\n\t\ttimeSinceUpdate = 0;\n\n\t\tconst extremes = getBVHExtremes( meshHelper.geometry.boundsTree );\n\t\tif ( initialExtremes === null ) {\n\n\t\t\tinitialExtremes = extremes;\n\n\t\t}\n\n\t\tlet score = 0;\n\t\tlet initialScore = 0;\n\t\tfor ( const i in extremes ) {\n\n\t\t\tscore += extremes[ i ].surfaceAreaScore;\n\t\t\tinitialScore += initialExtremes[ i ].surfaceAreaScore;\n\n\t\t}\n\n\t\tconst degradation = ( score / initialScore ) - 1.0;\n\n\t\t// update time display\n\t\toutputContainer.innerHTML =\n\t\t\t`mesh generation time: ${ generateTime.toFixed( 2 ) } ms\\n` +\n\t\t\t`refit time: ${ refitTime } ms\\n` +\n\t\t\t`bvh degradation: ${ ( 100 * degradation ).toFixed( 2 ) }%`;\n\n\t}\n\n}\n\nfunction render() {\n\n\tstats.update();\n\trequestAnimationFrame( render );\n\n\tconst delta = Math.min( clock.getDelta(), 30 * 0.001 );\n\n\t// update animation and helpers\n\tif ( mixer ) {\n\n\t\tmixer.update( delta );\n\t\tskeletonHelper.visible = params.skeletonHelper;\n\t\tmeshHelper.visible = params.display;\n\t\tbvhHelper.visible = params.bvhHelper;\n\t\tmodel.visible = params.displayOriginal;\n\n\t}\n\n\tscene.updateMatrixWorld( true );\n\n\t// refit on a cycle\n\tif ( params.autoUpdate && ! params.pause ) {\n\n\t\tif ( timeSinceUpdate > params.updateRate ) {\n\n\t\t\tregenerateMesh();\n\n\t\t}\n\n\t\ttimeSinceUpdate += delta;\n\n\t} else {\n\n\t\ttimeSinceUpdate = 0;\n\n\t}\n\n\trenderer.render( scene, camera );\n\n}\n"],"names":["f","e","$f4c59361c37dab96$exports","a","c","appendChild","dom","u","d","children","length","style","display","l","document","createElement","cssText","addEventListener","preventDefault","k","performance","Date","now","g","r","Panel","h","self","memory","t","REVISION","addPanel","showPanel","begin","end","update","usedJSHeapSize","jsHeapSizeLimit","this","domElement","setMode","Infinity","Math","round","window","devicePixelRatio","v","m","n","p","q","width","height","b","getContext","font","textBaseline","fillStyle","fillRect","fillText","globalAlpha","w","min","max","drawImage","define","amd","Stats","$hGT0Q","BufferGeometry","prototype","computeBoundsTree","$aBPXg","$27de474196eebf81$var$params","displayOriginal","material","updatePositionOnly","skeletonHelper","bvhHelper","bvhHelperDepth","autoUpdate","updateRate","pause","regenerate","$27de474196eebf81$var$regenerateMesh","$27de474196eebf81$var$renderer","$27de474196eebf81$var$camera","$27de474196eebf81$var$scene","$27de474196eebf81$var$clock","$27de474196eebf81$var$gui","$27de474196eebf81$var$stats","$27de474196eebf81$var$outputContainer","$27de474196eebf81$var$controls","$27de474196eebf81$var$mixer","$27de474196eebf81$var$animationAction","$27de474196eebf81$var$model","$27de474196eebf81$var$bvhHelper","$27de474196eebf81$var$skeletonHelper","$27de474196eebf81$var$meshHelper","$27de474196eebf81$var$staticGeometryGenerator","$27de474196eebf81$var$wireframeMaterial","$27de474196eebf81$var$normalMaterials","$27de474196eebf81$var$originalMaterials","$27de474196eebf81$var$timeSinceUpdate","$27de474196eebf81$var$initialExtremes","generateTime","refitTime","startTime","generate","geometry","boundsTree","refit","toFixed","extremes","getBVHExtremes","score","initialScore","i","surfaceAreaScore","degradation","innerHTML","getElementById","WebGLRenderer","antialias","setPixelRatio","setSize","innerWidth","innerHeight","setClearColor","shadowMap","enabled","type","PCFSoftShadowMap","outputEncoding","sRGBEncoding","body","Scene","light","DirectionalLight","position","set","shadow","mapSize","setScalar","normalBias","castShadow","shadowCam","camera","left","bottom","right","top","updateProjectionMatrix","add","AmbientLight","PerspectiveCamera","far","$W2bOH","OrbitControls","Clock","$parcel$interopDefault","$4EHgc","GLTFLoader","load","gltf","scene","meshes","traverse","object","isMesh","receiveShadow","frustumCulled","push","updateMatrixWorld","SkeletonHelper","visible","animations","AnimationMixer","clipAction","play","paused","box","Box3","setFromObject","getCenter","target","x","z","StaticGeometryGenerator","getMaterials","map","MeshNormalMaterial","normalMap","MeshBasicMaterial","wireframe","transparent","opacity","depthWrite","Mesh","MeshBVHVisualizer","plane","PlaneBufferGeometry","ShadowMaterial","color","rotation","PI","scale","$ghLil","GUI","staticFolder","addFolder","onChange","attributes","dispose","key","deleteAttribute","open","helperFolder","depth","parseInt","bvhFolder","aspect","$27de474196eebf81$var$init","$27de474196eebf81$var$render","requestAnimationFrame","delta","getDelta","render"],"version":3,"file":"skinnedMesh.bf15a73c.js.map"}